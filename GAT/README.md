# GridAnnotationTool

> 산림청에서 임산도 판별 프로젝트를 진행하는 도중, 데이터셋 관리/생성 유틸리티를 제작해 달라는 요청을 받아 C#으로 제작한 툴. 10000x10000에 육박하는, 또는 그보다 큰 이미지를 격자 형태로 잘라 라벨을 수동으로 매기고 있던 상황이었다. 해당 유틸리티 보급 이후 2~3일 정도 소요되던 작업이 4시간 내외로 종료되는 성과를 거두었다.

<p align="center">
  <img src="https://github.com/escaco95/ARCODA-Choismind/blob/main/SAMPLE-A.png?raw=true" width="400" height="250"><img src="https://github.com/escaco95/ARCODA-Choismind/blob/main/SAMPLE-B.png?raw=true" width="400" height="250">
</p>

**당시 업무 프로세스:**
 - 작업자가 격자 분할 툴로 임산도를 분할
 - 원래 이미지와 매칭하면서, 잘라낸 조각이 원래 어디였는지 구분(산,도로,밭 등)
 - 각각 다른 폴더에 분리하고 유효한 파일 이름으로 변경, 이후 TRAIN/VALID/TEST 세트로 구분

**요청 사항:**
 - 업무 프로세스가 한 화면에서 진행되지 못해(분할 도구, 탐색기, 이미지 뷰어 등) 작업 속도가 더딘 문제를 해결할 것 (ALL-IN-ONE 툴)
 - 라벨링의 변경이 용이할 것
> 50% 산, 50% 밭과 같은 경우를 예시로 들어주셨던 기억이 난다. 산으로도 넣어서 테스트해보고, 밭으로도 넣어서 테스트해보고. 영 아니다 싶으면 별도의 라벨링을 먹이거나, 아예 빼 버릴 생각인데. 기존 작업 방식으로는 시간을 너무 오래 잡아먹을 것 같으니 그 부분을 어떻게 잘 부탁한다고...

**개선을 위해 집중한 부분:**
 - ALL-IN-ONE 인터페이스
 - 미연에 발생할 수 있는 휴먼 에러의 방지, 실수가 발생하더라도 롤백이 용이할 것
 - 임의의 크기를 가진 조각에서 학습이 잘 되지 않을 경우, 조각의 크기를 변경해야 할 때 모든 작업을 처음부터 다시 해야 하는 문제

> 원본 임산도, 격자로 나뉘어진 구역과 라벨을 모두 한 화면에 표시하는 건 기본 기능이고, 크기가 큰 임산도의 특징 상 작업자가 어느 부분을 보고 있는지 알 수 있는 네비게이터가 필요하다고 생각했다.

> 이 유틸리티에는 메멘토 패턴이 적용되어야 했다. 다행히 Undo/Redo 기능을 이전에도 자주 만들어 봐서 어렵지 않게 해결할 수 있었다.

> Grid의 크기 및 오프셋을 레이어마다 다르게 지정할 수 있게 하여, 애매하게 걸친 영역도 라벨링이 가능하도록 구현했다.

**아쉬운 점들:**
 - 의뢰 수행 당시 GDI+의 드로잉 최적화에 대한 이해가 부족하여 라벨 숫자에 비례하여 성능 저하가 눈에 드러났었음
 - 플러드필 기능이 없었음

> 그래도 여전히 기존의 수동 작업보다는 압도적으로 빨라서 긍정적인 평가를 받을 수 있었다. 다시 작업하게 된다면 쓸데 없이 버퍼 수를 늘리지 않고, Zoom-Level based 쿼드트리 알고리즘을 적용하여 큰 성능 향상을 꾀할 것이다.

> 당시엔 의문의 성능 저하가 발생해서 로직 문제인가 싶다가 어딜 봐도 로직엔 문제가 없어서 그냥 솔직히 프로그램이 거의 멈춘다고 말씀드리고 기능을 롤백했는데. 일이 마무리되고 나서야 드로우콜을 최적화하지 못한 부분이 문제였다는 사실을 알았다. 어흑마이깟.

**후기:**
 - C#으로는 처음 받아 보고 성공적으로 완수한 의뢰였다.
